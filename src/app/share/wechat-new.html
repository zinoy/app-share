<div class="wrapper wrapper-content animated fadeInRight" ng-controller="ShareController as share">
        <div class="row wrapper border-bottom white-bg page-heading">
          <div class="col-sm-4">
            <h2>{{$state.current.data.pageTitle}}</h2>
            <ol class="breadcrumb">
              <li>
                <a ui-sref="share.index">Home</a>
              </li>
              <li class="active">
                  <strong>{{$state.current.data.title}}</strong>
              </li>
            </ol>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="wrapper wrapper-content">

              <div class="ibox">
                <div class="ibox-title">
                  <h5>HTML</h5>
                  <div ibox-tools control="iboxTools"></div>
                </div>
                <div class="ibox-content">
                  <ui-codemirror ui-codemirror-opts="share.htmlOptions" >&lt;!-- 在页面中引用微信JS -->
&lt;script src="//res.wx.qq.com/open/js/jweixin-1.2.0.js">&lt;/script></ui-codemirror>
                </div>
              </div>

              <div class="ibox">
                <div class="ibox-title">
                  <h5>Javascript</h5>
                  <div ibox-tools control="iboxTools"></div>
                </div>
                <div class="ibox-content">
                  <div class="alert alert-info"><i class="fa fa-info-circle"></i> 不依赖任何第三方JS库，但必须先引用<b>微信JS-SDK</b></div>
                  <p>把微信签名接口封装起来，自动根据H5域名调用【别克，雪佛兰，诚新二手车】微信签名接口。</p>
                  <h3>使用方法</h3>
                  <p>引用微信JS-SDK，然后将下方封装的JS代码复制到<code>&lt;/head&gt;</code>标签前。</p>
                  <p>默认<code>jsApiList</code>参数只请求了两个接口（<code>onMenuShareTimeline</code>和<code>onMenuShareAppMessage</code>），如果项目需要使用更多方法（如：扫描二维码、录音等），请参考 <a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421141115" target="_blank">官方文档 <i class="fa fa-external-link"></i></a> 来请求其他接口的权限。</p>
                  <h3>封装代码</h3>
                  <ui-codemirror ui-codemirror-opts="share.jsOptions">(function(e){function i(e){return e&&/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/g.test(e)}function n(i){i.debug=!!e.debug,i.jsApiList=e.jsApiList||["onMenuShareTimeline","onMenuShareAppMessage"],i.debug&&alert(JSON.stringify(i)),wx.config(i),wx.ready(function(){t(),l.shareCallback({errMsg:"ready:ok"})}),wx.error(function(e){l.shareCallback({errMsg:"ready:error"})})}function t(e){e=e||{};var n="function"==typeof e.shareCallback?e.shareCallback:l.shareCallback,t=e.url||l.url,a={title:e.title||l.title,desc:e.desc||l.desc,link:t,imgUrl:e.img?i(e.img)?e.img:r+e.img:l.img,success:n,cancel:n},s=new URL(t);s.search+="&origin=wechat-appMessage",a.link=s.href,wx.onMenuShareAppMessage(a);var c=e.tlUrl||l.tlUrl||t,g={title:e.timeline||l.timeline||a.title,link:c,imgUrl:e.tlImg?i(e.tlImg)?e.tlImg:r+e.tlImg:l.tlImg||a.imgUrl,success:n,cancel:n};s=new URL(c),s.search+="&origin=wechat-timeline",g.link=s.href,wx.onMenuShareTimeline(g)}if(!/MicroMessenger/i.test(navigator.userAgent))return console.warn("非微信浏览器，微信签名不会执行！"),function(){};var a=location.hostname;if(!window.wx)return void(a.indexOf("test")!=-1&&alert("确定页面已引用'//res.wx.qq.com/open/js/jweixin-1.2.0.js'"));var r=location.href.match(/http[\w:\.\/-]+\w\//)[0],l={title:e.title,timeline:e.timeline||(e.swap?e.desc:e.title),desc:e.desc||"￶",img:i(e.img)?e.img:r+(e.img||"images/share.jpg"),tlImg:e.tlImg?i(e.tlImg)?e.tlImg:r+(e.tlImg||"images/share.jpg"):"",url:e.url||r,tlUrl:e.tlUrl||e.url,shareCallback:"function"==typeof e.shareCallback?e.shareCallback:function(){}},s=new XMLHttpRequest;if(s.onreadystatechange=function(){4==s.readyState&&200==s.status&&n(JSON.parse(s.responseText))},a.indexOf("chevrolet.com.cn")!=-1)s.open("POST","//www.chevrolet.com.cn/chevy-api/getsign.aspx");else if(a.indexOf("buick.com.cn")!=-1)s.open("POST","//www.buick.com.cn/weixinjssign/getbuicksign.aspx");else{if("chengxinmobile.saic-gm.com"!=a)return;s.open("POST","//chengxinmobile.saic-gm.com/api/wexinsign.aspx")}var c=new FormData;return c.append("signurl",location.href.replace(/#.*$/gi,"")),s.send(c),t})
({
  title: "这是默认的分享标题",
  shareCallback: function(result) {
    console.log(JSON.stringify(result));
  }
});</ui-codemirror>
                  <h4>参数说明</h4>
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th>参数</th>
                        <th>类型</th>
                        <th>默认值</th>
                        <th>是否必须</th>
                        <th>说明</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>title</th>
                        <td>String</td>
                        <td>无</td>
                        <td>是</td>
                        <td>分享给好友的标题，默认情况下作为分享到朋友圈的内容</td>
                      </tr>
                      <tr>
                        <th>desc</th>
                        <td>String</td>
                        <td><code>"\ufff6"</code></td>
                        <td>否</td>
                        <td>分享给好友的描述，为空则不显示描述</td>
                      </tr>
                      <tr>
                        <th>timeline</th>
                        <td>String</td>
                        <td>无</td>
                        <td>否</td>
                        <td>分享到朋友圈的内容，如不指定，默认使用 <code>title</code> 参数</td>
                      </tr>
                      <tr>
                        <th>swap</th>
                        <td>Boolean</td>
                        <td><code>false</code></td>
                        <td>否</td>
                        <td>为 <code>true</code> 时将使用 <code>desc</code> 参数作为 <code>timeline</code> 的默认值</td>
                      </tr>
                      <tr>
                        <th>img</th>
                        <td>URL</td>
                        <td><code>"images/share.jpg"</code></td>
                        <td>否</td>
                        <td>分享图片</td>
                      </tr>
                      <tr>
                        <th>tlImg</th>
                        <td>URL</td>
                        <td>无</td>
                        <td>否</td>
                        <td>分享到朋友圈的图片，如不指定，默认使用 <code>img</code> 参数</td>
                      </tr>
                      <tr>
                        <th>url</th>
                        <td>URL</td>
                        <td>当前页面</td>
                        <td>否</td>
                        <td>分享的URL</td>
                      </tr>
                      <tr>
                        <th>tlUrl</th>
                        <td>URL</td>
                        <td>无</td>
                        <td>否</td>
                        <td>分享到朋友圈的URL，如不指定，默认使用 <code>url</code> 参数</td>
                      </tr>
                      <tr>
                        <th>debug</th>
                        <td>Boolean</td>
                        <td><code>false</code></td>
                        <td>否</td>
                        <td>是否开启JS-SDK的调试模式</td>
                      </tr>
                      <tr>
                        <th>jsApiList</th>
                        <td>Array</td>
                        <td><code>["onMenuShareTimeline", "onMenuShareAppMessage"]</code></td>
                        <td>否</td>
                        <td>请求权限的微信接口列表</td>
                      </tr>
                      <tr>
                        <th>shareCallback</th>
                        <td>Function</td>
                        <td>无</td>
                        <td>否</td>
                        <td>
                          <p>回调方法，在每一步完成时均会触发，适合放置监测代码</p>
                          <p>回调时会传入一个类型为JSON的参数，其包含以下属性：</p>
                          <ul>
                            <li><b>errMsg</b> 返回状态信息，可能的值包括：<code>ready:ok</code> <code>ready:error</code> <code>sendAppMessage:ok</code><br><code>sendAppMessage:cancel</code> <code>shareTimeline:ok</code> <code>shareTimeline:cancel</code></li>
                          </ul>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <h3>修改分享内容</h3>
                  <p>如果需要动态修改分享的内容，可以使用封装代码<b>返回</b>的函数，并传递一个包含修改内容的Objec对象（属性同上）。</p>
                  <div class="alert alert-warning"><i class="fa fa-exclamation-triangle"></i> <b>注意</b>：封装的脚本与修改分享内容使用的<b>不是</b>同一个函数。请不要也无需将封装的匿名函数赋值给变量，应直接执行并使用其<b>返回</b>的函数</div>
                  <h4>示例代码</h4>
                  <ui-codemirror ui-codemirror-opts="share.jsOptions">var setWeChatShare=function(e){function i(e){return e&&/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/g.test(e)}function n(i){i.debug=!!e.debug,i.jsApiList=e.jsApiList||["onMenuShareTimeline","onMenuShareAppMessage"],i.debug&&alert(JSON.stringify(i)),wx.config(i),wx.ready(function(){t(),l.shareCallback({errMsg:"ready:ok"})}),wx.error(function(e){l.shareCallback({errMsg:"ready:error"})})}function t(e){e=e||{};var n="function"==typeof e.shareCallback?e.shareCallback:l.shareCallback,t=e.url||l.url,a={title:e.title||l.title,desc:e.desc||l.desc,link:t,imgUrl:e.img?i(e.img)?e.img:r+e.img:l.img,success:n,cancel:n},s=new URL(t);s.search+="&origin=wechat-appMessage",a.link=s.href,wx.onMenuShareAppMessage(a);var c=e.tlUrl||l.tlUrl||t,g={title:e.timeline||l.timeline||a.title,link:c,imgUrl:e.tlImg?i(e.tlImg)?e.tlImg:r+e.tlImg:l.tlImg||a.imgUrl,success:n,cancel:n};s=new URL(c),s.search+="&origin=wechat-timeline",g.link=s.href,wx.onMenuShareTimeline(g)}if(!/MicroMessenger/i.test(navigator.userAgent))return console.warn("非微信浏览器，微信签名不会执行！"),function(){};var a=location.hostname;if(!window.wx)return void(a.indexOf("test")!=-1&&alert("确定页面已引用'//res.wx.qq.com/open/js/jweixin-1.2.0.js'"));var r=location.href.match(/http[\w:\.\/-]+\w\//)[0],l={title:e.title,timeline:e.timeline||(e.swap?e.desc:e.title),desc:e.desc||"￶",img:i(e.img)?e.img:r+(e.img||"images/share.jpg"),tlImg:e.tlImg?i(e.tlImg)?e.tlImg:r+(e.tlImg||"images/share.jpg"):"",url:e.url||r,tlUrl:e.tlUrl||e.url,shareCallback:"function"==typeof e.shareCallback?e.shareCallback:function(){}},s=new XMLHttpRequest;if(s.onreadystatechange=function(){4==s.readyState&&200==s.status&&n(JSON.parse(s.responseText))},a.indexOf("chevrolet.com.cn")!=-1)s.open("POST","//www.chevrolet.com.cn/chevy-api/getsign.aspx");else if(a.indexOf("buick.com.cn")!=-1)s.open("POST","//www.buick.com.cn/weixinjssign/getbuicksign.aspx");else{if("chengxinmobile.saic-gm.com"!=a)return;s.open("POST","//chengxinmobile.saic-gm.com/api/wexinsign.aspx")}var c=new FormData;return c.append("signurl",location.href.replace(/#.*$/gi,"")),s.send(c),t}
({title:"这是默认的分享标题",timeline:"这是分享到朋友圈的标题",desc:"这是分享给朋友的描述", img:"images/head3.png", shareCallback:function(value){alert(value.errMsg)}});

//可再定义分享内容
setWeChatShare({title:"分享的标题已改变"});
setWeChatShare({title:"分享的标题已改变", img:"images/xxxx.jpg"});</ui-codemirror>
                </div>
              </div>

              <div class="ibox">
                <div class="ibox-title">
                  <h5>APP判断脚本</h5>
                  <div ibox-tools control="iboxTools"></div>
                </div>
                <div class="ibox-content">
                  <ui-codemirror ui-codemirror-opts="share.jsOptions">var isWechat = /MicroMessenger/i.test(window.navigator.userAgent);</ui-codemirror>
                </div>
              </div>
              <div class="ibox">
                <div class="ibox-title">
                  <h5>参考</h5>
                  <div ibox-tools control="iboxTools"></div>
                </div>
                <div class="ibox-content">
                  <p>关于微信签名接口参见<a href="share/wechat#api">旧文档</a>。</p>
                  <p>源代码参见<a href="http://git.hylinkers.com/snippets/6" target="_blank">Git <i class="fa fa-external-link"></i></a>。</p>
                </div>
              </div>
              <div class="ibox">
                <div class="ibox-title">
                  <h5>案例</h5>
                  <div ibox-tools control="iboxTools"></div>
                </div>
                <div class="ibox-content">
                  <ul>
                    <li>别克微信签名 DEMO <a href="http://mobiletest.buick.com.cn/act/test/demo1.html" target="_blank">http://mobiletest.buick.com.cn/act/test/demo1.html <i class="fa fa-external-link"></i></a></li>
                    <li>雪佛兰微信签名 DEMO <a href="http://mobiletest.chevrolet.com.cn/act/malibu/malibuxl-perfectlife/demo2.html" target="_blank">http://mobiletest.chevrolet.com.cn/act/malibu/malibuxl-perfectlife/demo2.html <i class="fa fa-external-link"></i></a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>